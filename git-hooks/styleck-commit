#!/usr/bin/env bash
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin
export PATH

CURRENT_DIR=$(cd "$(dirname "$0")" || exit; pwd) # 当前脚本所在目录
PARENT_DIR=$(dirname "$CURRENT_DIR") # 当前脚本所在目录的上级目录

# 设置变量
REPO_DIR="${CURRENT_DIR}"  # 你的 Git 仓库路径
STYLE_CHECKER="eslint"  # 代码风格检查工具，例如 eslint 或 prettier

# 进入仓库目录
cd "$REPO_DIR" || exit 1

# 检查代码风格
echo "正在检查代码风格..."
$STYLE_CHECKER --fix

# 检查是否有风格问题
if git status --porcelain | grep -q '^ M'; then
    echo "代码风格检查发现问题，已自动修复。"
    echo "请再次提交更改。"
    exit 1
else
    echo "代码风格检查通过。"
fi